<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Grupos - KanbanDeep</title>
  <link rel="stylesheet" href="../static/universal.css">
  <link rel="stylesheet" href="../static/groups.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div id="message-container"></div>
  
  <header id="main-header">
    <div class="menu-container">
        <button id="user-avatar-btn" class="avatar-btn">
            <img id="user-avatar" src="" alt="Avatar do Usu√°rio">
        </button>
        <div id="profile-dropdown" class="dropdown">            
            <button id="switch-user-btn">üîÅ Trocar Perfil</button>
            <button id="user-profile-btn">üë§ Meu Perfil</button>
            <button id="kanban-btn">üìã Meus Quadros</button>
            <button id="friends-btn">üßë‚Äçü§ù‚Äçüßë Amigos</button>
            <button id="templates-btn">üé® Gerenciar Templates</button>
            <button id="notifications-btn">üîî Notifica√ß√µes</button>
            <hr>
            <button id="exit-btn">üö™ Sair</button>
        </div>
    </div>

    <h1 id="page-title">Grupos</h1>

    <div class="menu-container">
        <button id="actions-dropdown-btn" class="btn">‚ö° A√ß√µes</button>
        <div id="actions-dropdown" class="dropdown">
            <button id="undo-btn">‚Ü©Ô∏è Desfazer</button>
            <button id="redo-btn">‚Ü™Ô∏è Refazer</button>
        </div>
    </div>
  </header>
  
    <main class="card">
        <!-- NOVO: Sistema de abas com estilo de navbar -->
        <nav class="showcase-navbar">
            <button class="nav-item active" data-tab="my-groups">Meus Grupos</button>
            <button class="nav-item" data-tab="create-group">Criar Grupo</button>
            <button class="nav-item" data-tab="group-templates">Templates de Grupo</button>
            <button class="nav-item" data-tab="statistics">Estat√≠sticas</button>
            <button class="nav-item" data-tab="meetings">Reuni√µes</button>
            <button class="nav-item" data-tab="reports">Relat√≥rios</button>
            <button class="nav-item" data-tab="admin-servers">Administrar Servidores</button>
        </nav>

        <div class="tab-content active" id="my-groups">
            <div class="actions" style="margin-bottom: 20px; display: flex; justify-content: flex-end; gap: 10px;">
                <button id="btn-create-group" class="btn confirm"><span>‚ûï</span> Criar Novo Grupo</button>
            </div>
            <section class="form-section">
                <div class="section-header">
                    <h2>Grupos que Administro</h2>
                </div>
                <div id="admin-groups-grid" class="groups-grid"></div>
            </section>
            <section class="form-section">
                <div class="section-header">
                    <h2>Grupos que Participo</h2>
                </div>
                <div id="member-groups-grid" class="groups-grid"></div>
            </section>
        </div>

        <div class="tab-content" id="create-group">
            <form id="create-group-form" class="form-layout">
                <div class="form-column">
                    <div class="form-section">
                        <h3>Informa√ß√µes B√°sicas</h3>
                        <div class="form-group">
                            <label for="group-icon">√çcone do Grupo:</label>
                            <div class="icon-input-group">
                                <input type="text" id="group-icon" class="icon-display" readonly value="üë•">
                                <button type="button" id="btn-choose-group-icon" class="btn btn-sm">Escolher</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="group-name">Nome do Grupo:</label>
                            <input type="text" id="group-name" required>
                        </div>
                        <div class="form-group">
                            <label for="group-description">Descri√ß√£o:</label>
                            <textarea id="group-description" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="group-access">Acesso:</label>
                            <div class="custom-select">
                                <select id="group-access">
                                    <option value="public">P√∫blico (qualquer um pode pedir para entrar)</option>
                                    <option value="private">Privado (apenas por convite)</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="form-section">
                        <h3>Membros</h3>
                        <div class="form-group">
                            <label for="group-members">Adicionar Membros (segure Ctrl/Cmd para selecionar v√°rios):</label>
                            <select id="group-members" multiple size="5"></select>
                        </div>
                    </div>
                </div>
                <div class="form-column">
                    <div class="form-section">
                        <h3>Quadros Iniciais</h3>
                        <div id="group-boards-container"></div>
                        <button type="button" id="btn-add-board" class="btn alternative1" style="width: 100%; margin-top: 10px;">Adicionar Quadro</button>
                    </div>
                    <div class="form-section">
                        <h3>Conjunto de Etiquetas Padr√£o</h3>
                        <div class="form-group">
                            <label for="group-tag-template">Usar um conjunto de etiquetas:</label>
                            <div class="custom-select">
                                <select id="group-tag-template"></select>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
            <div class="actions">
                <button id="btn-cancel-group" class="btn cancel">Cancelar</button>
                <button id="btn-save-group" class="btn confirm">Criar Grupo</button>
            </div>
        </div>

        <div class="tab-content" id="group-templates">
            <div class="template-type-buttons" style="margin-bottom: 20px; display: flex; justify-content: flex-end; gap: 10px;">
                <button id="btn-new-board-template" class="btn confirm">Novo Template de Quadro</button>
                <button id="btn-new-tag-template" class="btn confirm">Novo Conjunto de Etiquetas</button>
            </div>
            <div class="templates-sections">
                <div class="template-section">
                    <h3>Templates de Quadro</h3>
                    <div id="group-board-templates-grid" class="templates-grid"></div>
                </div>
                <div class="template-section">
                    <h3>Conjuntos de Etiquetas</h3>
                    <div id="group-tag-templates-grid" class="templates-grid"></div>
                </div>
            </div>
        </div>

        <div class="tab-content" id="statistics">
            <div class="card-header" style="flex-wrap: wrap;">
                <div class="filters" style="width: 100%;">
                    <label for="stats-group-select">Selecionar Grupo:</label>
                    <div class="custom-select stats-filter"><select id="stats-group-select" class="filter-select"></select></div>
                    <div class="custom-select stats-filter"><select id="time-filter" class="filter-select">
                        <option value="all">Todo o Per√≠odo</option>
                        <option value="last30">√öltimos 30 dias</option>
                        <option value="last7">√öltimos 7 dias</option>
                        <option value="today">Hoje</option>
                    </select></div>
                    <div class="custom-select stats-filter"><select id="chart-type" class="filter-select">
                        <option value="pie">Gr√°fico de Pizza</option>
                        <option value="bar">Gr√°fico de Barras</option>
                        <option value="line">Gr√°fico de Linha</option>
                    </select></div>
                </div>
            </div>
            <div class="stats-sections">
                <div class="stats-section">
                    <h3>Resumo</h3>
                    <div class="stats-summary">
                        <div class="stat-item">
                            <span class="stat-number" id="total-cards">0</span>
                            <span class="stat-label">Total de Tarefas</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number" id="completed-cards">0</span>
                            <span class="stat-label">Conclu√≠das</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number" id="active-cards">0</span>
                            <span class="stat-label">Ativas</span>
                        </div>
                    </div>
                </div>
                <div class="stats-section">
                    <h3>Desempenho dos Participantes</h3>
                    <table class="participants-table">
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Fun√ß√£o</th>
                                <th>Tarefas Conclu√≠das</th>
                                <th>Produtividade</th>
                            </tr>
                        </thead>
                        <tbody id="participants-table-body"></tbody>
                    </table>
                </div>
                <div class="stats-section">
                    <h3>Status dos Cart√µes</h3>
                    <div class="chart-container">
                        <canvas id="status-chart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-content" id="meetings">
            <button id="btn-schedule-meeting" class="btn confirm" style="margin-bottom: 20px;">Agendar Nova Reuni√£o</button>
            <div id="meetings-list" class="meetings-list"></div>
        </div>

        <div class="tab-content" id="reports">
            <section class="form-section">
                <div class="card-header">
                    <h2>Gerador de Relat√≥rios de Atividade</h2>
                    <div class="filters">
                        <div class="custom-select report-filter">
                            <select id="report-group-select"></select>
                        </div>
                        <div class="custom-select report-filter">
                            <select id="report-period-select">
                                <option value="daily">Di√°rio</option>
                                <option value="weekly">Semanal</option>
                                <option value="monthly">Mensal</option>
                            </select>
                        </div>
                        <button id="generate-report-btn" class="btn confirm">Gerar Relat√≥rio</button>
                    </div>
                </div>
                <div id="report-container"></div>
            </section>
        </div>

        <div class="tab-content" id="admin-servers">
            <div class="actions" style="margin-bottom: 20px; display: flex; justify-content: flex-end; gap: 10px;">
                <button id="btn-create-server" class="btn confirm">Criar Servidor Local</button>
                <button id="btn-add-server" class="btn alternative1">Adicionar Servidor Externo</button>
            </div>
            <div class="servers-list"></div>
        </div>
    </main>

    <!-- Di√°logos -->
    <dialog id="edit-group-dialog" class="draggable">
        <h3 class="drag-handle">Editar Grupo</h3>
        <form id="edit-group-form" class="form-layout">
            <div class="form-column">
                <div class="form-section">
                    <h3>Informa√ß√µes do Grupo</h3>
                    <div class="form-group">
                        <label for="edit-group-icon">√çcone:</label>
                        <div class="icon-input-group">
                            <input type="text" id="edit-group-icon" class="icon-display" readonly>
                            <button type="button" id="btn-choose-edit-group-icon" class="btn btn-sm">Escolher</button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="edit-group-name">Nome do Grupo:</label>
                        <input type="text" id="edit-group-name" required>
                    </div>
                    <div class="form-group">
                        <label for="edit-group-description">Descri√ß√£o:</label>
                        <textarea id="edit-group-description" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="edit-group-access">Acesso:</label>
                        <div class="custom-select">
                            <select id="edit-group-access">
                                <option value="public">P√∫blico</option>
                                <option value="private">Privado</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="edit-group-tag-template">Conjunto de Etiquetas Padr√£o:</label>
                        <div class="custom-select">
                            <select id="edit-group-tag-template"></select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-column">
                <div class="form-section">
                    <h3>Participantes</h3>
                    <div id="group-members-list"></div>
                    <button type="button" id="btn-add-participant" class="btn alternative1" style="width: 100%; margin-top: 10px;">Adicionar Participante</button>
                </div>
                <div class="form-section">
                    <h3>Relat√≥rios Autom√°ticos</h3>
                    <div class="form-group">
                        <label for="edit-group-report-frequency">Frequ√™ncia:</label>
                        <div class="custom-select">
                            <select id="edit-group-report-frequency">
                                <option value="none">Nenhum</option>
                                <option value="daily">Di√°rio</option>
                                <option value="weekly">Semanal</option>
                                <option value="monthly">Mensal</option>
                            </select>
                        </div>
                    </div>
                    <div id="edit-group-report-day-of-week-container" class="form-group hidden">
                        <label for="edit-group-report-day-of-week">Dia da Semana:</label>
                        <div class="custom-select">
                            <select id="edit-group-report-day-of-week">
                                <option value="1">Segunda-feira</option>
                                <option value="2">Ter√ßa-feira</option>
                                <option value="3">Quarta-feira</option>
                                <option value="4">Quinta-feira</option>
                                <option value="5">Sexta-feira</option>
                                <option value="6">S√°bado</option>
                                <option value="0">Domingo</option>
                            </select>
                        </div>
                    </div>
                    <div id="edit-group-report-day-of-month-container" class="form-group hidden">
                        <label for="edit-group-report-day-of-month">Dia do M√™s:</label>
                        <input type="number" id="edit-group-report-day-of-month" min="1" max="31" value="1">
                    </div>
                </div>
            </div>
            <div class="feedback"></div>
        </form>
        <div class="modal-actions">
            <button id="cancel-edit-group" class="btn cancel">Cancelar</button>
            <button type="submit" form="edit-group-form" class="btn confirm">Salvar Altera√ß√µes</button>
        </div>
    </dialog>

    <dialog id="add-participant-dialog" class="draggable">
        <h3 class="drag-handle">Adicionar Participante</h3>
        <div class="form-group">
            <label for="participant-select">Selecione um usu√°rio para convidar:</label>
            <div class="custom-select">
                <select id="participant-select"></select>
            </div>
        </div>
        <div class="feedback"></div>
        <div class="modal-actions">
            <button id="cancel-add-participant" class="btn cancel">Cancelar</button>
            <button id="confirm-add-participant" class="btn confirm">Enviar Convite</button>
        </div>
    </dialog>

    <dialog id="add-board-to-group-dialog" class="draggable">
        <h3 class="drag-handle">Adicionar Quadro ao Grupo</h3>
        <div class="form-group">
            <label for="add-board-title-input">Nome do Quadro:</label>
            <input type="text" id="add-board-title-input">
        </div>
        <div class="form-group">
            <label for="add-board-template-select">Usar Template do Sistema:</label>
            <div class="custom-select">
                <select id="add-board-template-select"></select>
            </div>
        </div>
        <div class="form-group">
            <label for="add-board-description-input">Descri√ß√£o:</label>
            <textarea id="add-board-description-input" rows="2"></textarea>
        </div>
        <div class="form-group">
            <label for="add-board-icon-input">√çcone:</label>
            <div class="icon-input-group">
                <input type="text" id="add-board-icon-input" class="icon-display" readonly value="üìã">
                <button type="button" id="btn-choose-add-board-icon" class="btn btn-sm">Escolher</button>
            </div>
        </div>
        <div class="feedback"></div>
        <div class="modal-actions">
            <button id="cancel-add-board-to-group-btn" class="btn cancel">Cancelar</button>
            <button id="confirm-add-board-to-group-btn" class="btn confirm">Adicionar</button>
        </div>
    </dialog>

    <dialog id="meeting-dialog" class="draggable">
        <h3 class="drag-handle">Agendar Reuni√£o</h3>
        <div class="form-group">
            <label for="meeting-group-select">Grupo:</label>
            <div class="custom-select"><select id="meeting-group-select"></select></div>
        </div>
        <div class="form-group">
            <label for="meeting-title">T√≠tulo:</label>
            <input type="text" id="meeting-title">
        </div>
        <div class="form-group">
            <label for="meeting-date">Data:</label>
            <input type="date" id="meeting-date">
        </div>
        <div class="form-group">
            <label for="meeting-time">Hora:</label>
            <input type="time" id="meeting-time">
        </div>
        <div class="form-group">
            <label for="meeting-location">Local (Opcional):</label>
            <input type="text" id="meeting-location" placeholder="Ex: Sala de Confer√™ncia, Link do Meet">
        </div>
        <div class="form-group">
            <label for="meeting-description">Descri√ß√£o (Opcional):</label>
            <textarea id="meeting-description" rows="2" placeholder="Pauta da reuni√£o..."></textarea>
        </div>
        <div class="feedback"></div>
        <div class="modal-actions">
            <button id="cancel-meeting-btn" class="btn cancel">Cancelar</button>
            <button id="save-meeting-btn" class="btn confirm">Agendar e Notificar</button>
        </div>
    </dialog>

    <dialog id="server-dialog" class="draggable">
        <h3 class="drag-handle" id="server-dialog-title">Criar Servidor</h3>
        <div class="form-group"><label for="server-name">Nome do Servidor:</label><input type="text" id="server-name"></div>
        <div class="feedback"></div>
        <div class="modal-actions">
            <button id="cancel-server-btn" class="btn cancel">Cancelar</button>
            <button id="confirm-server-btn" class="btn confirm">Criar</button>
        </div>
    </dialog>

    <dialog id="add-server-dialog" class="draggable">
        <h3 class="drag-handle">Adicionar Servidor Externo</h3>
        <div class="form-group">
            <label for="server-url">URL do Servidor:</label>
            <div class="input-with-button">
                <input type="text" id="server-url" placeholder="https://exemplo.com">
                <button id="paste-server-btn" class="btn alternative1">Colar</button>
            </div>
        </div>
        <div class="feedback"></div>
        <div class="modal-actions">
            <button id="cancel-add-server-btn" class="btn cancel">Cancelar</button>
            <button id="confirm-add-server-btn" class="btn confirm">Adicionar</button>
        </div>
    </dialog>

    <dialog id="share-server-dialog" class="draggable">
        <h3 class="drag-handle">Compartilhar Servidor</h3>
        <div class="form-group">
            <label for="server-share-url">URL para Compartilhar:</label>
            <input type="text" id="server-share-url" readonly>
            <button id="copy-server-url-btn" class="btn">Copiar</button>
        </div>
        <div class="feedback"></div>
        <div class="modal-actions">
            <button id="close-share-dialog-btn" class="btn cancel">Fechar</button>
        </div>
    </dialog>

    <!-- Di√°logos de template foram removidos daqui, pois agora s√£o criados dinamicamente pela fun√ß√£o universal -->

  <script type="module" src="../js/main.js"></script>
</body>
</html>
