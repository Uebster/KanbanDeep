<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KanbanDeep - Meus Quadros</title>
    <link rel="stylesheet" href="../static/universal.css">
    <link rel="stylesheet" href="../static/kanban.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <div id="app">
        <!-- NOVO CABE√áALHO COM MENUS SUSPENSOS -->
<!-- Em kanban.html -->
<header id="main-header">
    <!-- Menu de Perfil (Esquerda) -->
    <div class="menu-container">
        <button id="user-avatar-btn" class="avatar-btn">
            <img id="user-avatar" src="" alt="Avatar do Usu√°rio">
        </button>
        <div id="profile-dropdown" class="dropdown">       
            <button id="switch-user-btn">üîÅ Trocar Perfil</button>
            <button id="user-profile-btn">üë§ Meu Perfil</button>
            <button id="my-groups-btn">üë• Meus Grupos</button>
            <button id="friends-btn">üßë‚Äçü§ù‚Äçüßë Amigos</button>
            <button id="templates-btn">üé® Gerenciar Templates</button>
            <button id="notifications-btn">üîî Notifica√ß√µes</button>
            <hr>     
            <button id="preferences-btn">üõ†Ô∏è Prefer√™ncias</button>
            <button id="exit-btn">üö™ Sair</button>
        </div>
    </div>

    <!-- Menu de Quadros (Centro) -->
    <div class="menu-container horizontal-menu">
        <button id="boards-dropdown-btn" class="btn">üìã Meus Quadros</button>
        <div id="boards-dropdown" class="dropdown">
            <div id="board-filter-toggle">
                <button class="filter-btn active" data-filter="personal">Pessoal</button>
                <button class="filter-btn" data-filter="group">Grupos</button>
            </div>
            <select id="board-select">
                <option value="">Selecione um quadro</option>
            </select>
            <button id="add-board-btn">‚ûï Adicionar Quadro</button>
            <button id="add-column-btn">üìå Adicionar Coluna</button>
            <button id="add-card-btn">üìù Adicionar Cart√£o</button>
            <button id="edit-items-btn">‚úèÔ∏è Editar/Excluir</button>
        </div>
    </div>

    <!-- Menu de A√ß√µes (Direita) -->
    <div class="menu-container">
        <button id="actions-dropdown-btn" class="btn">‚ö° A√ß√µes</button>
        <div id="actions-dropdown" class="dropdown">
            <button id="undo-btn">‚Ü©Ô∏è Desfazer</button>
            <button id="redo-btn">‚Ü™Ô∏è Refazer</button>
            <hr>
            <button id="save-as-template-btn">üíæ Salvar como Template</button>
            <button id="print-btn">üñ®Ô∏è Imprimir</button>
            <button id="export-img">üñºÔ∏è Exportar Imagem</button>
        </div>
    </div>
</header>

        <!-- √Årea principal do Kanban -->
        <main id="main-area">
            <h1 id="kanban-title">Carregando...</h1>
            
            <!-- Filtros (mantidos como antes) -->
            <div id="filters-container">
                <!-- Grupos de filtros ser√£o inseridos aqui pelo JS ou mantidos est√°ticos -->
            </div>

            <!-- Container das colunas do Kanban -->
            <div id="columns-container">
                <!-- As colunas ser√£o renderizadas aqui pelo JavaScript -->
            </div>
        </main>
    </div>

    <!-- Di√°logos (Modais) - Estrutura mantida -->
    <dialog id="board-dialog" class="draggable">
    <h3 class="drag-handle" id="board-dialog-title">Configurar Quadro</h3>
    <div class="form-group">
        <label for="board-template-select">Usar um Template (Opcional):</label>
        <select id="board-template-select">
            <!-- Preenchido pelo JS -->
        </select>
    </div>
    <div class="form-group">
        <label for="board-title-input">T√≠tulo:</label>
        <input type="text" id="board-title-input">
    </div>
    <div class="form-group">
        <label for="board-description-input">Descri√ß√£o (Opcional):</label>
        <textarea id="board-description-input" rows="2" placeholder="Adicione uma breve descri√ß√£o para este quadro..."></textarea>
    </div>
        <!-- Bloco de √çcone Adicionado -->
        <div class="form-group">
            <label for="board-icon-input">√çcone:</label>
            <div class="icon-input-group">
                <input type="text" id="board-icon-input" class="icon-display" readonly>
                <button type="button" id="btn-choose-board-icon" class="btn btn-sm">Escolher</button>
            </div>
        </div>
        <div class="form-group">
            <label for="board-visibility">Visibilidade:</label>
            <select id="board-visibility">
                <option value="private">Privado</option>
                <option value="public">P√∫blico</option>
                <option value="group">Grupo</option>
            </select>
        </div>
        <div class="form-group" id="board-group-container" style="display:none;">
            <label for="board-group-select">Grupo:</label>
            <select id="board-group-select"></select>
        </div>
            <div class="feedback"></div> <!-- <-- Adicione esta linha -->
    <div class="modal-actions">
        <div class="modal-actions">
            <button id="board-cancel-btn" class="btn btn-secondary">Cancelar</button>
            <button id="board-save-btn" class="btn btn-primary">Salvar</button>
        </div>
    </dialog>

    <dialog id="column-dialog" class="draggable">
        <h3 class="drag-handle">Configurar Coluna</h3>
        <div class="form-group">
            <label for="column-title-input">Nome:</label>
            <input type="text" id="column-title-input">
        </div>
        <div class="form-group">
            <label for="column-description">Descri√ß√£o/Instru√ß√£o:</label>
            <textarea id="column-description" rows="2"></textarea>
        </div>
        <div class="form-group">
            <label for="column-color-input">Cor da Coluna:</label>
            <input type="color" id="column-color-input" value="#282828">
        </div>
        <div class="form-group">
            <label for="column-text-color-input">Cor do Texto:</label>
            <input type="color" id="column-text-color-input" value="#e0e0e0">
        </div>
            <div class="feedback"></div> <!-- <-- Adicione esta linha -->
    <div class="modal-actions">
        <div class="modal-actions">
            <button id="column-cancel-btn" class="btn btn-secondary">Cancelar</button>
            <button id="column-delete-btn" class="btn btn-danger">Excluir</button>
            <button id="column-save-btn" class="btn btn-primary">Salvar</button>
        </div>
    </dialog>

    <dialog id="card-dialog" class="draggable">
    <h3 class="drag-handle">Configurar Cart√£o</h3>
        <div class="form-group" id="card-column-select-group">
        <label for="card-column-select">Coluna:</label>
        <select id="card-column-select"></select>
    </div>
    <div class="form-group">
        <label for="card-title-input">T√≠tulo do Cart√£o:</label>
        <input type="text" id="card-title-input">
    </div>
    <div class="form-group">
        <label for="card-description">Descri√ß√£o:</label>
        <textarea id="card-description" rows="3"></textarea>
    </div>
    
    <!-- CAMPO DE DATA E HORA SEPARADOS -->
    <div class="form-row">
        <div class="form-group">
            <label for="card-due-date">Data de Vencimento:</label>
            <input type="date" id="card-due-date">
        </div>
        <div class="form-group">
            <label for="card-due-time">Hora:</label>
            <input type="time" id="card-due-time">
        </div>
    </div>
    
    <!-- CAMPO DE ETIQUETAS AGORA √â UM SELECT M√öLTIPLO -->
    <div class="form-group">
        <label for="card-tags">Etiquetas (segure Ctrl/Cmd para selecionar v√°rias):</label>
        <select id="card-tags" multiple size="5">
            <!-- Op√ß√µes preenchidas pelo JS -->
        </select>
    </div>
    
    <!-- O resto do formul√°rio continua igual -->
    <div class="form-group">
        <label for="card-assigned-to">Atribuir a:</label>
        <select id="card-assigned-to"></select>
    </div>
    
    <!-- ELEMENTO DE FEEDBACK ADICIONADO -->
    <div class="feedback"></div>

    <div class="modal-actions">
        <button class="btn btn-secondary" onclick="this.closest('dialog').close()">Cancelar</button>
        <button id="card-save-btn" class="btn btn-primary">Salvar Cart√£o</button>
    </div>
</dialog>

    <dialog id="confirm-dialog">
        <h3 id="confirm-title" class="drag-handle">Confirmar A√ß√£o</h3>
        <p id="confirm-message">Voc√™ tem certeza?</p>
        <div class="modal-actions">
            <button id="confirm-cancel-btn" class="btn btn-secondary">Cancelar</button>
            <button id="confirm-ok-btn" class="btn btn-danger">Confirmar</button>
        </div>
    </dialog>

    <dialog id="edit-dialog" class="draggable">
    <h3 class="drag-handle">Editar / Excluir Itens</h3>
    
    <div class="form-group">
        <label for="edit-select-board">Selecione o Quadro:</label>
        <select id="edit-select-board"></select>
    </div>
    
    <div class="form-group" id="edit-column-group" style="display: none;">
        <label for="edit-select-column">Selecione a Coluna (Opcional):</label>
        <select id="edit-select-column"></select>
    </div>
    
    <div class="form-group" id="edit-card-group" style="display: none;">
        <label for="edit-select-card">Selecione o Cart√£o (Opcional):</label>
        <select id="edit-select-card"></select>
    </div>
    
    <p class="edit-info">Selecione um item para habilitar as a√ß√µes.</p>
    
    <div class="modal-actions">
        <button id="edit-dialog-cancel-btn" class="btn btn-secondary">Cancelar</button>
        <button id="edit-dialog-delete-btn" class="btn btn-danger" disabled>Excluir Selecionado</button>
        <button id="edit-dialog-edit-btn" class="btn btn-primary" disabled>Editar Selecionado</button>
    </div>
</dialog>

<dialog id="search-dialog" class="draggable">
    <h3 class="drag-handle">Procurar e Filtrar Cart√µes</h3>
    
    <div class="form-group">
        <label for="search-text">Texto no t√≠tulo ou descri√ß√£o:</label>
        <input type="text" id="search-text" placeholder="Digite para buscar...">
    </div>

    <!-- CAMPO ADICIONADO -->
    <div class="form-group">
        <label for="search-creator">Por Criador:</label>
        <select id="search-creator">
            <!-- Op√ß√µes preenchidas pelo JS -->
        </select>
    </div>

    <!-- CAMPO ADICIONADO -->
    <div class="form-group">
        <label for="search-status">Status:</label>
        <select id="search-status">
            <option value="">Todos</option>
            <option value="active">Pendentes</option>
            <option value="completed">Conclu√≠dos</option>
        </select>
    </div>

    <div class="form-group">
        <label for="search-assignee">Atribu√≠do a:</label>
        <select id="search-assignee">
            <!-- Op√ß√µes preenchidas pelo JS -->
        </select>
    </div>

    <div class="form-group">
        <label for="search-due-date">Data de Vencimento:</label>
        <select id="search-due-date">
            <option value="">Todas</option>
            <option value="today">Vence Hoje</option>
            <option value="week">Vence esta Semana</option>
            <option value="overdue">Atrasado</option>
        </select>
    </div>

    <div class="form-group">
        <label for="search-tags">Etiqueta:</label>
        <select id="search-tags">
            <!-- Op√ß√µes preenchidas pelo JS -->
        </select>
    </div>
    
    <div class="modal-actions">
        <button id="search-cancel-btn" class="btn btn-secondary">Fechar</button>
        <button id="search-reset-btn" class="btn">Limpar Filtros</button>
        <button id="search-apply-btn" class="btn btn-primary">Aplicar Filtros</button>
    </div>
</dialog>

<dialog id="details-dialog" class="draggable">
    <h3 class="drag-handle" id="details-title">Detalhes do Item</h3>
    <div id="details-content">
        <!-- O conte√∫do ser√° preenchido pelo JavaScript -->
    </div>
    <div class="modal-actions">
        <button class="btn btn-secondary" onclick="this.closest('dialog').close()">Fechar</button>
    </div>
</dialog>
    <!-- Di√°logo de Prefer√™ncias -->
<dialog id="preferences-dialog" class="draggable">
    <h3 class="drag-handle">Prefer√™ncias</h3>
    
    <div class="preferences-layout">
        <!-- Coluna Esquerda: Prefer√™ncias Gerais -->
        <div class="preferences-column">
            <div class="form-group">
                <label for="pref-theme">Tema:</label>
                <div class="custom-select">
                    <select id="pref-theme">
                        <option value="auto">Padr√£o do Sistema</option>
                        <option value="dark">Escuro (Preto)</option>
                        <option value="dark-gray">Cinza Escuro</option>
                        <option value="light-gray">Cinza Claro</option>
                        <option value="light">Claro (Branco)</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <label for="pref-language">Idioma:</label>
                <div class="custom-select">
                    <select id="pref-language">
                        <option value="pt-BR">Portugu√™s (Brasil)</option>
                        <option value="en-US">English (EUA)</option>
                        <option value="es-ES">Espa√±ol (Espa√±a)</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <label for="pref-font-family">Fonte:</label>
                <div class="custom-select">
                    <select id="pref-font-family">
                        <option value="Segoe UI, Inter, sans-serif">Padr√£o (Segoe/Inter)</option>
                        <option value="Roboto, sans-serif">Roboto</option>
                        <option value="Open Sans, sans-serif">Open Sans</option>
                        <option value="Lato, sans-serif">Lato</option>
                        <option value="Montserrat, sans-serif">Montserrat</option>
                        <option value="Verdana, sans-serif">Verdana</option>
                        <option value="Arial, sans-serif">Arial</option>
                        <option value="Helvetica, sans-serif">Helvetica</option>
                        <option value="Times New Roman, serif">Times New Roman</option>
                        <option value="Courier New, monospace">Courier New</option>
                        <option value="Georgia, serif">Georgia</option>
                        <option value="Palatino, serif">Palatino</option>
                        <option value="Garamond, serif">Garamond</option>
                        <option value="Comic Sans MS, cursive">Comic Sans MS</option>
                        <option value="Impact, fantasy">Impact</option>
                        <option value="Tahoma, sans-serif">Tahoma</option>
                        <option value="Trebuchet MS, sans-serif">Trebuchet MS</option>
                        <option value="Lucida Sans Unicode, sans-serif">Lucida Sans Unicode</option>
                        <option value="Lucida Console, monospace">Lucida Console</option>
                        <option value="Lucida Sans, sans-serif">Lucida Sans</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <label for="pref-font-size">Tamanho da Fonte:</label>
                <div class="custom-select">
                    <select id="pref-font-size">
                        <option value="small">Pequeno</option>
                        <option value="medium">M√©dio</option>
                        <option value="large">Grande</option>
                        <option value="x-large">Extra Grande</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <label>Cor Prim√°ria:</label>
                <div id="color-palette-container" class="color-palette">
                    <div class="color-swatch special" data-action="remove-primary" title="Nenhuma">üö´</div>
                    <div class="color-swatch" style="background-color: #4cd4e6;" data-hex="#4cd4e6" data-rgb="76, 212, 230" title="Padr√£o"></div>
                    <div class="color-swatch" style="background-color: #9a1eff;" data-hex="#9a1eff" data-rgb="154, 30, 255"></div>
                    <div class="color-swatch" style="background-color: #1eff1e;" data-hex="#1eff1e" data-rgb="30, 255, 30"></div>
                    <div class="color-swatch" style="background-color: #f552ed;" data-hex="#f552ed" data-rgb="245, 82, 237"></div>
                    <div class="color-swatch" style="background-color: #ff831e;" data-hex="#ff831e" data-rgb="255, 131, 30"></div>
                    <div class="color-swatch" style="background-color: #1e47ff;" data-hex="#1e47ff" data-rgb="30, 71, 255"></div>
                    <div class="color-swatch" style="background-color: #ff1e1e;" data-hex="#ff1e1e" data-rgb="255, 30, 30"></div>
                    <div class="color-swatch" style="background-color: #c3ff1e;" data-hex="#c3ff1e" data-rgb="195, 255, 30"></div>
                    <div class="color-swatch" style="background-color: #ffd700;" data-hex="#ffd700" data-rgb="255, 215, 0"></div>
                    <div class="color-swatch" style="background-color: #ffffff;" data-hex="#ffffff" data-rgb="255, 255, 255"></div>
                    <div class="color-swatch" style="background-color: #000000;" data-hex="#000000" data-rgb="0, 0, 0"></div>
                </div>
            </div>
        </div>
        <!-- Coluna Direita: Prefer√™ncias de Exibi√ß√£o -->
        <div class="preferences-column">
            <fieldset class="form-group">
                <legend>Exibir no Quadro:</legend>
                <label class="checkbox-container"> T√≠tulo do Quadro
                    <input type="checkbox" id="pref-board-show-title" checked>
                    <span class="checkmark"></span>
                </label>
                <label class="checkbox-container"> √çcone do Quadro
                    <input type="checkbox" id="pref-board-show-icon" checked>
                    <span class="checkmark"></span>
                </label>
            </fieldset>
            <fieldset class="form-group">
                <legend>Exibir no Cart√£o:</legend>
                <label class="checkbox-container"> Etiquetas
                    <input type="checkbox" id="pref-card-show-tags" checked>
                    <span class="checkmark"></span>
                </label>
                <label class="checkbox-container"> Data de Vencimento
                    <input type="checkbox" id="pref-card-show-date" checked>
                    <span class="checkmark"></span>
                </label>
                <label class="checkbox-container"> Status (Conclu√≠do)
                    <input type="checkbox" id="pref-card-show-status" checked>
                    <span class="checkmark"></span>
                </label>
                <label class="checkbox-container"> Usu√°rio Atribu√≠do
                    <input type="checkbox" id="pref-card-show-assignment" checked>
                    <span class="checkmark"></span>
                </label>
                <label class="checkbox-container"> Detalhes ao Passar o Mouse
                    <input type="checkbox" id="pref-card-show-details" checked>
                    <span class="checkmark"></span>
                </label>
            </fieldset>
            <div class="form-group">
                <label for="pref-default-tag-template">Conjunto de Etiquetas Padr√£o:</label>
                <div class="custom-select">
                    <select id="pref-default-tag-template"></select>
                </div>
            </div>
        </div>
    </div>
        <div class="form-group">
    </div>

    <div class="feedback"></div>

    <div class="modal-actions">
        <button id="pref-cancel-btn" class="btn btn-secondary">Cancelar</button>
        <button id="pref-save-btn" class="btn btn-primary">Salvar</button>
    </div>
</dialog>

<!-- Di√°logo do Seletor de √çcones (Adicionar no final) -->
<dialog id="icon-picker-dialog" class="draggable">
    <h3 class="drag-handle">Selecione um √çcone</h3>
    <div id="icon-grid">
        <!-- √çcones ser√£o inseridos aqui pelo JavaScript -->
    </div>
    <div class="modal-actions">
        <button id="close-icon-picker-btn" class="btn btn-secondary">Fechar</button>
    </div>
</dialog>


    <!-- Container para mensagens flutuantes -->
    <div id="message-container"></div>

    <!-- Scripts -->
<script type="module" src="../js/main.js"></script>
</body>
</html>
